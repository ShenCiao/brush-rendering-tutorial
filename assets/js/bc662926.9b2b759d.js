"use strict";(self.webpackChunkbrush_stroke_tutorial=self.webpackChunkbrush_stroke_tutorial||[]).push([[805],{5034:(e,t,n)=>{n.d(t,{r:()=>l});var r=n(7462),o=n(7294);const a={comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"[",close:"]"},{open:"{",close:"}"},{open:"(",close:")"},{open:"'",close:"'",notIn:["string","comment"]},{open:'"',close:'"',notIn:["string"]}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},i={tokenPostfix:".glsl",defaultToken:"invalid",keywords:["const","uniform","break","continue","do","for","while","if","else","switch","case","in","out","inout","true","false","invariant","discard","return","sampler2D","samplerCube","sampler3D","struct","radians","degrees","sin","cos","tan","asin","acos","atan","pow","sinh","cosh","tanh","asinh","acosh","atanh","exp","log","exp2","log2","sqrt","inversesqrt","abs","sign","floor","ceil","round","roundEven","trunc","fract","mod","modf","min","max","clamp","mix","step","smoothstep","length","distance","dot","cross ","determinant","inverse","normalize","faceforward","reflect","refract","matrixCompMult","outerProduct","transpose","lessThan ","lessThanEqual","greaterThan","greaterThanEqual","equal","notEqual","any","all","not","packUnorm2x16","unpackUnorm2x16","packSnorm2x16","unpackSnorm2x16","packHalf2x16","unpackHalf2x16","dFdx","dFdy","fwidth","textureSize","texture","textureProj","textureLod","textureGrad","texelFetch","texelFetchOffset","textureProjLod","textureLodOffset","textureGradOffset","textureProjLodOffset","textureProjGrad","intBitsToFloat","uintBitsToFloat","floatBitsToInt","floatBitsToUint","isnan","isinf","vec2","vec3","vec4","ivec2","ivec3","ivec4","uvec2","uvec3","uvec4","bvec2","bvec3","bvec4","mat2","mat3","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","mat4","float","int","uint","void","bool"],operators:["=",">","<","!","~","?",":","==","<=",">=","!=","&&","||","++","--","+","-","*","/","&","|","^","%","<<",">>",">>>","+=","-=","*=","/=","&=","|=","^=","%=","<<=",">>=",">>>="],symbols:/[=><!~?:&|+\-*\/\^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,integersuffix:/([uU](ll|LL|l|L)|(ll|LL|l|L)?[uU]?)/,floatsuffix:/[fFlL]?/,encoding:/u|u8|U|L/,tokenizer:{root:[[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword.$0"},"@default":"identifier"}}],[/^\s*#\s*\w+/,"keyword.directive"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"],[/[;,.]/,"delimiter"]],comment:[[/[^\/*]+/,"comment"],[/\/\*/,"comment","@push"],["\\*/","comment","@pop"],[/[\/*]/,"comment"]],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]]}};var s=n(3764);function l(e){return o.createElement(s.ML,(0,r.Z)({},e,{defaultLanguage:"glsl",onMount:(t,n)=>{n.languages.register({id:"glsl"}),n.languages.setMonarchTokensProvider("glsl",i),n.languages.setLanguageConfiguration("glsl",a),"function"==typeof e.onMount&&e.onMount(t,n)}}))}},4956:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>b,contentTitle:()=>x,default:()=>L,frontMatter:()=>h,metadata:()=>w,toc:()=>y});var r=n(7462),o=n(7294),a=n(3905),i=n(9477),s=n(5452),l=n(4866),c=n(5162),u=n(3764),d=n(5034);function m(e){let{geometry:t,vertexShader:n,fragmentShader:r,showEditor:a=null}=e;const m=(0,o.useRef)(),f=(0,o.useRef)(),p=(0,o.useRef)(),g=(0,o.useRef)();function v(e,t,n){const r=[...t],o=[...t.slice(2)],a=[...n],s=[...n.slice(1)],l=[];let c=0;for(let m=0;m<n.length-1;++m){const e=2*m,r=new i.FM8(t[e],t[e+1]),o=new i.FM8(t[e+2],t[e+3]);let u=n[m],d=n[m+1];const f=1e-5;(u<=0||u/d<f)&&(u=f*d,a[m]=u),(d<=0||d/u<f)&&(d=f*u,s[m]=d);let p=r.distanceTo(o);c+=u<=0&&d<=0?0:u==d?p/u:Math.log(u/d)/(u-d)*p,l.push(c)}const u=[0,...l],d=[...l];e.setAttribute("position0",new i.lb7(new Float32Array(r),2)),e.setAttribute("radius0",new i.lb7(new Float32Array(a),1)),e.setAttribute("position1",new i.lb7(new Float32Array(o),2)),e.setAttribute("radius1",new i.lb7(new Float32Array(s),1)),e.setAttribute("summedLength0",new i.lb7(new Float32Array(u),1)),e.setAttribute("summedLength1",new i.lb7(new Float32Array(d),1))}function h(e,t){const n=p.current.material;e&&(n.vertexShader=e),t&&(n.fragmentShader=t),n.needsUpdate=!0,f.current()}(0,o.useEffect)((()=>{const e=(1+Math.sqrt(5))/2,o=m.current.clientWidth,a=o*(.5/e),l=6*e,c=l*(.5/e),u=new i.iKG(l/-2,l/2,c/2,c/-2,-1e3,1e3);u.position.z=5;const d=new i.CP7({preserveDrawingBuffer:!0,powerPreference:"high-performance",antialias:!0,alpha:!0,premultipliedAlpha:!1});function h(){const t=m.current.clientWidth,n=.5*t/e;d.setSize(t,n)}d.setClearColor(new i.Ilk(1,1,1),0),d.setSize(o,a),g.current=d,window.addEventListener("resize",h),m.current.appendChild(d.domElement);const x=new i.xsS,w=new s.o(u,d.domElement);w.enableRotate=!1,w.enableDamping=!1,w.screenSpacePanning=!0,w.addEventListener("change",(()=>{d.render(x,u)})),f.current=()=>d.render(x,u),window.addEventListener("TextureLoaded",f.current);let b=new i.u9r;if("string"==typeof t){const e=[0,1,2,2,3,0];b.setIndex(e);const n=new Function(t),[r,o]=n();v(b,r,o)}else{if(!(t instanceof i.u9r))return void console.error("Unrecognized geometry input: "+typeof t);b=t}const y=new i.FIo({vertexShader:n,fragmentShader:r,side:i.ehD,transparent:!0,glslVersion:i.LSk});return p.current=new i.SPe(b,y,b.getAttribute("position0").count-1),p.current.frustumCulled=!1,x.add(p.current),f.current(),()=>{d.dispose(),window.removeEventListener("resize",h),window.removeEventListener("TextureLoaded",f.current)}}),[]);const x=(0,o.useCallback)(((e,t)=>{let n=[],r=[];try{const t=new Function(e);[n,r]=t()}catch(a){return void console.log(a.toString())}function o(e){if(Array.isArray(e)){for(let t=0;t<e.length;t++)if("number"!=typeof e[t])return!1;return!0}return!1}o(n)&&o(r)&&n.length==2*r.length?(v(p.current.geometry,n,r),p.current.count=n.length-1,f.current()):console.error("return value is not correct")}),[]),w="40vh";let b=!0,y=!0,k=!0;return Array.isArray(a)&&([b,y,k]=a),t instanceof i.u9r&&(b=!1),o.createElement(o.Fragment,null,o.createElement("div",{style:{display:a?null:"none"}},o.createElement(l.Z,{defaultValue:""},b&&o.createElement(c.Z,{value:"geometry.js"},o.createElement(u.ZP,{height:w,defaultLanguage:"javascript",defaultValue:t,onChange:x})),y&&o.createElement(c.Z,{value:"vertex.glsl"},o.createElement(d.r,{height:w,defaultValue:n,onChange:e=>{h(e,"")}})),k&&o.createElement(c.Z,{value:"fragment.glsl"},o.createElement(d.r,{height:w,defaultValue:r,onChange:e=>{h("",e)}})))),o.createElement("div",{ref:m,style:{width:"100%"},onMouseDown:e=>{e.preventDefault(),2==e.button&&console.log(g.current.domElement.toDataURL())}}))}const f="precision mediump float;\nprecision mediump int;\n\n// Take golbal const values as uniforms to modify freely.\nconst float radius = 1.0/10.0;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix; // orthogonal projection\n\nin vec2 position0;\nin vec2 position1;\nin vec3 color0;\nin vec3 color1;\n\nout vec2 p;\nflat out vec2 p0;\nflat out vec2 p1;\nflat out float r;\nout vec3 color;\n\nvoid main(){\n    p0 = position0;\n    p1 = position1;\n    r = radius;\n\n    vec2 tangent = normalize(p1 - p0);\n    vec2 normal = vec2(-tangent.y, tangent.x);\n\n    color = vec3[](color0, color0, color1, color1)[gl_VertexID];\n    vec2 offsetSign = vec2[](\n    vec2(-1.0, -1.0),\n    vec2(-1.0, 1.0),\n    vec2(1.0, 1.0),\n    vec2(1.0, -1.0)\n    )[gl_VertexID];\n    vec2 position = vec2[](p0, p0, p1, p1)[gl_VertexID];\n    vec2 vertexPosition = position +\n    offsetSign.x * r * tangent +\n    offsetSign.y * r * normal;\n\n    p = vertexPosition;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(p, 0.0, 1.0);\n}",p="precision mediump float;\nprecision mediump int;\n\nin vec2 p;\nflat in vec2 p0;\nflat in vec2 p1;\nflat in float r;\nin vec3 color;\n\nout vec4 outColor;\n\nvoid main() {\n    vec2 tangent = normalize(p1 - p0);\n    vec2 normal = vec2(-tangent.y, tangent.x);\n\n    float len = distance(p1, p0);\n    vec2 pLocal = vec2(dot(p-p0, tangent), dot(p-p0, normal));\n\n    float d0 = distance(p, p0);\n    float d1 = distance(p, p1);\n\n    // Remove corners\n    if(pLocal.x < 0.0 && d0 > r) discard;\n    if(pLocal.x > len && d1 > r) discard;\n\n    outColor = vec4(color, 1.0);\n}";function g(){let e=[0,1,-Math.sqrt(3)/2,-.5,Math.sqrt(3)/2,-.5];e.push(e[0],e[1]);const t=[1,0,0,0,1,0,0,0,1];t.push(...t.slice(0,3));const n=[...e],r=[...e.slice(2)],o=[...t],a=[...t.slice(3)],s=new i.u9r;return s.setIndex([0,1,2,2,3,0]),s.setAttribute("position0",new i.lb7(new Float32Array(n),2)),s.setAttribute("position1",new i.lb7(new Float32Array(r),2)),s.setAttribute("color0",new i.lb7(new Float32Array(o),3)),s.setAttribute("color1",new i.lb7(new Float32Array(a),3)),s}function v(){return o.createElement(m,{geometry:g(),vertexShader:f,fragmentShader:p,showEditor:[!1,!0,!0]})}const h={sidebar_position:1},x=void 0,w={unversionedId:"Basics/Vanilla/Vanilla",id:"Basics/Vanilla/Vanilla",title:"Vanilla",description:"Shader code will be introduced in this article. Feel free to play with.",source:"@site/docs/Basics/Vanilla/Vanilla.mdx",sourceDirName:"Basics/Vanilla",slug:"/Basics/Vanilla/",permalink:"/brush-rendering-tutorial/Basics/Vanilla/",draft:!1,editUrl:"https://github.com/ShenCiao/brush-rendering-tutorial/tree/main/docs/Basics/Vanilla/Vanilla.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Basics",permalink:"/brush-rendering-tutorial/Basics/Basics/"},next:{title:"Tessellation",permalink:"/brush-rendering-tutorial/Tessellation/"}},b={},y=[],k={toc:y},A="wrapper";function L(e){let{components:t,...n}=e;return(0,a.kt)(A,(0,r.Z)({},k,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(v,{mdxType:"RGBTriangle"}),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"Shader code will be introduced in this article. Feel free to play with.")),(0,a.kt)("h1",{id:"todo"},"TODO"))}L.isMDXComponent=!0}}]);